{"ast":null,"code":"import _regenerator from \"C:/Users/als40/Desktop/HandsMarket/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"C:/Users/als40/Desktop/HandsMarket/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _jsxFileName = \"C:\\\\Users\\\\als40\\\\Desktop\\\\HandsMarket\\\\frontend\\\\src\\\\pages\\\\product\\\\recommend.tsx\",\n  _this = this,\n  _s = $RefreshSig$();\nimport React from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { collection, query, where, getDocs, limit } from \"firebase/firestore\";\nimport { db } from \"../../firebase/firebaseConfig\";\nimport { BeatLoader } from \"react-spinners\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar fetchRecommendedProducts = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee(tags, currentProductId) {\n    var productsRef, q, snapshot;\n    return _regenerator().w(function (_context) {\n      while (1) switch (_context.n) {\n        case 0:\n          if (!(!tags || tags.length === 0)) {\n            _context.n = 1;\n            break;\n          }\n          return _context.a(2, []);\n        case 1:\n          productsRef = collection(db, \"product\");\n          q = query(productsRef, where(\"tags\", \"array-contains-any\", tags), limit(5));\n          _context.n = 2;\n          return getDocs(q);\n        case 2:\n          snapshot = _context.v;\n          return _context.a(2, snapshot.docs.map(function (doc) {\n            var data = doc.data();\n            return {\n              id: doc.id,\n              title: data.title,\n              image: data.image,\n              price: data.price,\n              tags: data.tags\n            };\n          }).filter(function (p) {\n            return p.id !== currentProductId;\n          }));\n      }\n    }, _callee);\n  }));\n  return function fetchRecommendedProducts(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\nvar Recommend = function Recommend(_ref2) {\n  _s();\n  var tags = _ref2.tags,\n    currentProductId = _ref2.currentProductId;\n  var _useQuery = useQuery({\n      queryKey: [\"recommended\", tags, currentProductId],\n      queryFn: function queryFn() {\n        return fetchRecommendedProducts(tags, currentProductId);\n      },\n      enabled: tags.length > 0\n    }),\n    data = _useQuery.data,\n    isLoading = _useQuery.isLoading,\n    isError = _useQuery.isError;\n  if (isLoading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex justify-center items-center h-20\",\n    children: /*#__PURE__*/_jsxDEV(BeatLoader, {\n      color: \"#9CA3AF\",\n      size: 13,\n      margin: 3\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 7\n  }, _this);\n  if (isError || !data || data.length === 0) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"\\uCD94\\uCC9C \\uC0C1\\uD488\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 12\n  }, _this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"text-lg font-semibold mb-4\",\n      children: \"\\uB2E4\\uB978 \\uACE0\\uAC1D\\uC774 \\uD568\\uAED8 \\uBCF8 \\uC0C1\\uD488\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"grid grid-cols-4 gap-6\",\n      children: data.map(function (product) {\n        return /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"cursor-pointer\",\n          onClick: function onClick() {\n            return window.location.href = \"/product/\".concat(product.id);\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: product.image,\n            alt: product.title,\n            className: \"w-full h-40 object-cover rounded\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"mt-2\",\n            children: product.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 13\n          }, _this)]\n        }, product.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }, _this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, _this);\n};\n_s(Recommend, \"MSjTYoPrHxtduNXA41YFDDh1ZTg=\", false, function () {\n  return [useQuery];\n});\n_c = Recommend;\nexport default Recommend;\nvar _c;\n$RefreshReg$(_c, \"Recommend\");","map":{"version":3,"names":["React","useQuery","collection","query","where","getDocs","limit","db","BeatLoader","jsxDEV","_jsxDEV","fetchRecommendedProducts","_ref","_asyncToGenerator","_regenerator","m","_callee","tags","currentProductId","productsRef","q","snapshot","w","_context","n","length","a","v","docs","map","doc","data","id","title","image","price","filter","p","_x","_x2","apply","arguments","Recommend","_ref2","_s","_useQuery","queryKey","queryFn","enabled","isLoading","isError","className","children","color","size","margin","fileName","_jsxFileName","lineNumber","columnNumber","_this","product","onClick","window","location","href","concat","src","alt","_c","$RefreshReg$"],"sources":["C:/Users/als40/Desktop/HandsMarket/frontend/src/pages/product/recommend.tsx"],"sourcesContent":["import React from \"react\";\r\nimport { useQuery } from \"@tanstack/react-query\";\r\nimport {\r\n  collection,\r\n  query,\r\n  where,\r\n  getDocs,\r\n  limit,\r\n  DocumentData,\r\n} from \"firebase/firestore\";\r\nimport { db } from \"../../firebase/firebaseConfig\";\r\nimport { BeatLoader } from \"react-spinners\";\r\n\r\ninterface Product {\r\n  id: string;\r\n  title: string;\r\n  image: string;\r\n  price: number;\r\n  tags?: string[];\r\n}\r\n\r\ninterface RecommendProps {\r\n  tags: string[];\r\n  currentProductId: string;\r\n}\r\n\r\nconst fetchRecommendedProducts = async (\r\n  tags: string[],\r\n  currentProductId: string\r\n): Promise<Product[]> => {\r\n  if (!tags || tags.length === 0) return [];\r\n\r\n  const productsRef = collection(db, \"product\");\r\n  const q = query(\r\n    productsRef,\r\n    where(\"tags\", \"array-contains-any\", tags),\r\n    limit(5)\r\n  );\r\n  const snapshot = await getDocs(q);\r\n\r\n  return snapshot.docs\r\n    .map((doc) => {\r\n      const data = doc.data() as DocumentData;\r\n      return {\r\n        id: doc.id,\r\n        title: data.title,\r\n        image: data.image,\r\n        price: data.price,\r\n        tags: data.tags,\r\n      };\r\n    })\r\n    .filter((p) => p.id !== currentProductId);\r\n};\r\n\r\nconst Recommend: React.FC<RecommendProps> = ({ tags, currentProductId }) => {\r\n  const { data, isLoading, isError } = useQuery({\r\n    queryKey: [\"recommended\", tags, currentProductId],\r\n    queryFn: () => fetchRecommendedProducts(tags, currentProductId),\r\n    enabled: tags.length > 0,\r\n  });\r\n\r\n  if (isLoading)\r\n    return (\r\n      <div className=\"flex justify-center items-center h-20\">\r\n        <BeatLoader color=\"#9CA3AF\" size={13} margin={3} />\r\n      </div>\r\n    );\r\n\r\n  if (isError || !data || data.length === 0)\r\n    return <p>추천 상품이 없습니다.</p>;\r\n\r\n  return (\r\n    <div>\r\n      <h3 className=\"text-lg font-semibold mb-4\">다른 고객이 함께 본 상품</h3>\r\n      <ul className=\"grid grid-cols-4 gap-6\">\r\n        {data.map((product) => (\r\n          <li\r\n            key={product.id}\r\n            className=\"cursor-pointer\"\r\n            onClick={() => (window.location.href = `/product/${product.id}`)}\r\n          >\r\n            <img\r\n              src={product.image}\r\n              alt={product.title}\r\n              className=\"w-full h-40 object-cover rounded\"\r\n            />\r\n            <h4 className=\"mt-2\">{product.title}</h4>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Recommend;\r\n"],"mappings":";;;;;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,QAAQ,uBAAuB;AAChD,SACEC,UAAU,EACVC,KAAK,EACLC,KAAK,EACLC,OAAO,EACPC,KAAK,QAEA,oBAAoB;AAC3B,SAASC,EAAE,QAAQ,+BAA+B;AAClD,SAASC,UAAU,QAAQ,gBAAgB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAe5C,IAAMC,wBAAwB;EAAA,IAAAC,IAAA,GAAAC,iBAAA,cAAAC,YAAA,GAAAC,CAAA,CAAG,SAAAC,QAC/BC,IAAc,EACdC,gBAAwB;IAAA,IAAAC,WAAA,EAAAC,CAAA,EAAAC,QAAA;IAAA,OAAAP,YAAA,GAAAQ,CAAA,WAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,CAAA;QAAA;UAAA,MAEpB,CAACP,IAAI,IAAIA,IAAI,CAACQ,MAAM,KAAK,CAAC;YAAAF,QAAA,CAAAC,CAAA;YAAA;UAAA;UAAA,OAAAD,QAAA,CAAAG,CAAA,IAAS,EAAE;QAAA;UAEnCP,WAAW,GAAGjB,UAAU,CAACK,EAAE,EAAE,SAAS,CAAC;UACvCa,CAAC,GAAGjB,KAAK,CACbgB,WAAW,EACXf,KAAK,CAAC,MAAM,EAAE,oBAAoB,EAAEa,IAAI,CAAC,EACzCX,KAAK,CAAC,CAAC,CACT,CAAC;UAAAiB,QAAA,CAAAC,CAAA;UAAA,OACsBnB,OAAO,CAACe,CAAC,CAAC;QAAA;UAA3BC,QAAQ,GAAAE,QAAA,CAAAI,CAAA;UAAA,OAAAJ,QAAA,CAAAG,CAAA,IAEPL,QAAQ,CAACO,IAAI,CACjBC,GAAG,CAAC,UAACC,GAAG,EAAK;YACZ,IAAMC,IAAI,GAAGD,GAAG,CAACC,IAAI,CAAC,CAAiB;YACvC,OAAO;cACLC,EAAE,EAAEF,GAAG,CAACE,EAAE;cACVC,KAAK,EAAEF,IAAI,CAACE,KAAK;cACjBC,KAAK,EAAEH,IAAI,CAACG,KAAK;cACjBC,KAAK,EAAEJ,IAAI,CAACI,KAAK;cACjBlB,IAAI,EAAEc,IAAI,CAACd;YACb,CAAC;UACH,CAAC,CAAC,CACDmB,MAAM,CAAC,UAACC,CAAC;YAAA,OAAKA,CAAC,CAACL,EAAE,KAAKd,gBAAgB;UAAA,EAAC;MAAA;IAAA,GAAAF,OAAA;EAAA,CAC5C;EAAA,gBA1BKL,wBAAwBA,CAAA2B,EAAA,EAAAC,GAAA;IAAA,OAAA3B,IAAA,CAAA4B,KAAA,OAAAC,SAAA;EAAA;AAAA,GA0B7B;AAED,IAAMC,SAAmC,GAAG,SAAtCA,SAAmCA,CAAAC,KAAA,EAAmC;EAAAC,EAAA;EAAA,IAA7B3B,IAAI,GAAA0B,KAAA,CAAJ1B,IAAI;IAAEC,gBAAgB,GAAAyB,KAAA,CAAhBzB,gBAAgB;EACnE,IAAA2B,SAAA,GAAqC5C,QAAQ,CAAC;MAC5C6C,QAAQ,EAAE,CAAC,aAAa,EAAE7B,IAAI,EAAEC,gBAAgB,CAAC;MACjD6B,OAAO,EAAE,SAATA,OAAOA,CAAA;QAAA,OAAQpC,wBAAwB,CAACM,IAAI,EAAEC,gBAAgB,CAAC;MAAA;MAC/D8B,OAAO,EAAE/B,IAAI,CAACQ,MAAM,GAAG;IACzB,CAAC,CAAC;IAJMM,IAAI,GAAAc,SAAA,CAAJd,IAAI;IAAEkB,SAAS,GAAAJ,SAAA,CAATI,SAAS;IAAEC,OAAO,GAAAL,SAAA,CAAPK,OAAO;EAMhC,IAAID,SAAS,EACX,oBACEvC,OAAA;IAAKyC,SAAS,EAAC,uCAAuC;IAAAC,QAAA,eACpD1C,OAAA,CAACF,UAAU;MAAC6C,KAAK,EAAC,SAAS;MAACC,IAAI,EAAE,EAAG;MAACC,MAAM,EAAE;IAAE;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,GAAAC,KAAE;EAAC;IAAAJ,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,GAAAC,KAChD,CAAC;EAGV,IAAIV,OAAO,IAAI,CAACnB,IAAI,IAAIA,IAAI,CAACN,MAAM,KAAK,CAAC,EACvC,oBAAOf,OAAA;IAAA0C,QAAA,EAAG;EAAY;IAAAI,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,GAAAC,KAAG,CAAC;EAE5B,oBACElD,OAAA;IAAA0C,QAAA,gBACE1C,OAAA;MAAIyC,SAAS,EAAC,4BAA4B;MAAAC,QAAA,EAAC;IAAc;MAAAI,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,GAAAC,KAAI,CAAC,eAC9DlD,OAAA;MAAIyC,SAAS,EAAC,wBAAwB;MAAAC,QAAA,EACnCrB,IAAI,CAACF,GAAG,CAAC,UAACgC,OAAO;QAAA,oBAChBnD,OAAA;UAEEyC,SAAS,EAAC,gBAAgB;UAC1BW,OAAO,EAAE,SAATA,OAAOA,CAAA;YAAA,OAASC,MAAM,CAACC,QAAQ,CAACC,IAAI,eAAAC,MAAA,CAAeL,OAAO,CAAC7B,EAAE,CAAE;UAAA,CAAE;UAAAoB,QAAA,gBAEjE1C,OAAA;YACEyD,GAAG,EAAEN,OAAO,CAAC3B,KAAM;YACnBkC,GAAG,EAAEP,OAAO,CAAC5B,KAAM;YACnBkB,SAAS,EAAC;UAAkC;YAAAK,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,GAAAC,KAC7C,CAAC,eACFlD,OAAA;YAAIyC,SAAS,EAAC,MAAM;YAAAC,QAAA,EAAES,OAAO,CAAC5B;UAAK;YAAAuB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,GAAAC,KAAK,CAAC;QAAA,GATpCC,OAAO,CAAC7B,EAAE;UAAAwB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,GAAAC,KAUb,CAAC;MAAA,CACN;IAAC;MAAAJ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,GAAAC,KACA,CAAC;EAAA;IAAAJ,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,GAAAC,KACF,CAAC;AAEV,CAAC;AAAChB,EAAA,CAtCIF,SAAmC;EAAA,QACFzC,QAAQ;AAAA;AAAAoE,EAAA,GADzC3B,SAAmC;AAwCzC,eAAeA,SAAS;AAAC,IAAA2B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}