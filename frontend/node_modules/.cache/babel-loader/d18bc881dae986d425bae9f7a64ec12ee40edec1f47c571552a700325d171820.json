{"ast":null,"code":"import _slicedToArray from \"C:/Users/als40/Desktop/HandsMarket/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _regenerator from \"C:/Users/als40/Desktop/HandsMarket/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"C:/Users/als40/Desktop/HandsMarket/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _jsxFileName = \"C:\\\\Users\\\\als40\\\\Desktop\\\\HandsMarket\\\\frontend\\\\src\\\\components\\\\modal\\\\search.tsx\",\n  _this = this,\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { FiSearch } from \"react-icons/fi\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { db } from \"../../firebase/firebaseConfig\";\nimport { collection, getDocs } from \"firebase/firestore\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar fetchProductTitles = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n    var snapshot;\n    return _regenerator().w(function (_context) {\n      while (1) switch (_context.n) {\n        case 0:\n          _context.n = 1;\n          return getDocs(collection(db, \"product\"));\n        case 1:\n          snapshot = _context.v;\n          return _context.a(2, snapshot.docs.map(function (doc) {\n            return {\n              id: doc.id,\n              title: doc.data().title\n            };\n          }));\n      }\n    }, _callee);\n  }));\n  return function fetchProductTitles() {\n    return _ref.apply(this, arguments);\n  };\n}();\nvar SearchPageModal = function SearchPageModal(_ref2) {\n  _s();\n  var onClose = _ref2.onClose;\n  var _useState = useState(\"\"),\n    _useState2 = _slicedToArray(_useState, 2),\n    searchTerm = _useState2[0],\n    setSearchTerm = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    filteredKeywords = _useState4[0],\n    setFilteredKeywords = _useState4[1];\n  var _useQuery = useQuery({\n      queryKey: [\"productTitles\"],\n      queryFn: fetchProductTitles\n    }),\n    products = _useQuery.data;\n  useEffect(function () {\n    if (!searchTerm || !products) {\n      setFilteredKeywords([]);\n      return;\n    }\n    var matches = products.map(function (product) {\n      return product.title;\n    }).filter(function (title) {\n      return title.toLowerCase().includes(searchTerm.toLowerCase());\n    });\n    setFilteredKeywords(matches.slice(0, 5));\n  }, [searchTerm, products]);\n  var handleSearchChange = function handleSearchChange(event) {\n    setSearchTerm(event.target.value);\n  };\n  var handleSearchSelect = function handleSearchSelect(selectedKeyword) {\n    window.location.href = \"/searchresult?query=\".concat(selectedKeyword);\n  };\n  var handleKeyDown = function handleKeyDown(e) {\n    if (e.key === \"Enter\" && searchTerm.trim()) {\n      window.location.href = \"/searchresult?query=\".concat(searchTerm);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 z-[2000] bg-black bg-opacity-50 flex items-start justify-center pt-[1rem]\",\n    onClick: onClose,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white dark:bg-gray-800 w-[1024px] rounded-lg relative\",\n      onClick: function onClick(e) {\n        return e.stopPropagation();\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center w-full relative\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          className: \"h-[3.5rem] w-full px-6 rounded-lg text-base border bg-gray-100 dark:text-gray-700\",\n          placeholder: \"\\uC544\\uC774\\uD15C\\uC744 \\uAC80\\uC0C9\\uD574\\uBCF4\\uC138\\uC694\",\n          value: searchTerm,\n          onChange: handleSearchChange,\n          onKeyDown: handleKeyDown\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(FiSearch, {\n          className: \"absolute right-4 text-gray-700 text-xl cursor-pointer\",\n          onClick: function onClick() {\n            return searchTerm.trim() && (window.location.href = \"/searchresult?query=\".concat(searchTerm));\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, _this), filteredKeywords.length > 0 && /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"max-h-8font-semibold text-lg px-2 bg-white rounded shadow\",\n        children: filteredKeywords.map(function (keyword, index) {\n          return /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"px-4 py-4 flex items-center border-b border-gray-100 cursor-pointer hover:bg-gray-50 dark:text-gray-600\",\n            onClick: function onClick() {\n              return handleSearchSelect(keyword);\n            },\n            children: [/*#__PURE__*/_jsxDEV(FiSearch, {\n              className: \"mr-2 text-gray-600 text-xl\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 17\n            }, _this), keyword]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 15\n          }, _this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, _this);\n};\n_s(SearchPageModal, \"P54bIULWekFYdVx3kzTzHbM1znE=\", false, function () {\n  return [useQuery];\n});\n_c = SearchPageModal;\nexport default SearchPageModal;\nvar _c;\n$RefreshReg$(_c, \"SearchPageModal\");","map":{"version":3,"names":["React","useState","useEffect","FiSearch","useQuery","db","collection","getDocs","jsxDEV","_jsxDEV","fetchProductTitles","_ref","_asyncToGenerator","_regenerator","m","_callee","snapshot","w","_context","n","v","a","docs","map","doc","id","title","data","apply","arguments","SearchPageModal","_ref2","_s","onClose","_useState","_useState2","_slicedToArray","searchTerm","setSearchTerm","_useState3","_useState4","filteredKeywords","setFilteredKeywords","_useQuery","queryKey","queryFn","products","matches","product","filter","toLowerCase","includes","slice","handleSearchChange","event","target","value","handleSearchSelect","selectedKeyword","window","location","href","concat","handleKeyDown","e","key","trim","className","onClick","children","stopPropagation","type","placeholder","onChange","onKeyDown","fileName","_jsxFileName","lineNumber","columnNumber","_this","length","keyword","index","_c","$RefreshReg$"],"sources":["C:/Users/als40/Desktop/HandsMarket/frontend/src/components/modal/search.tsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { FiSearch } from \"react-icons/fi\";\r\nimport { useQuery } from \"@tanstack/react-query\";\r\nimport { db } from \"../../firebase/firebaseConfig\";\r\nimport { collection, getDocs } from \"firebase/firestore\";\r\n\r\ninterface Product {\r\n  id: string;\r\n  title: string;\r\n}\r\n\r\nconst fetchProductTitles = async (): Promise<Product[]> => {\r\n  const snapshot = await getDocs(collection(db, \"product\"));\r\n  return snapshot.docs.map((doc) => ({\r\n    id: doc.id,\r\n    title: doc.data().title,\r\n  }));\r\n};\r\n\r\ninterface SearchPageModalProps {\r\n  onClose: () => void;\r\n}\r\n\r\nconst SearchPageModal: React.FC<SearchPageModalProps> = ({ onClose }) => {\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [filteredKeywords, setFilteredKeywords] = useState<string[]>([]);\r\n\r\n  const { data: products } = useQuery<Product[]>({\r\n    queryKey: [\"productTitles\"],\r\n    queryFn: fetchProductTitles,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!searchTerm || !products) {\r\n      setFilteredKeywords([]);\r\n      return;\r\n    }\r\n\r\n    const matches = products\r\n      .map((product) => product.title)\r\n      .filter((title) =>\r\n        title.toLowerCase().includes(searchTerm.toLowerCase())\r\n      );\r\n\r\n    setFilteredKeywords(matches.slice(0, 5));\r\n  }, [searchTerm, products]);\r\n\r\n  const handleSearchChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    setSearchTerm(event.target.value);\r\n  };\r\n\r\n  const handleSearchSelect = (selectedKeyword: string) => {\r\n    window.location.href = `/searchresult?query=${selectedKeyword}`;\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (e.key === \"Enter\" && searchTerm.trim()) {\r\n      window.location.href = `/searchresult?query=${searchTerm}`;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className=\"fixed inset-0 z-[2000] bg-black bg-opacity-50 flex items-start justify-center pt-[1rem]\"\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        className=\"bg-white dark:bg-gray-800 w-[1024px] rounded-lg relative\"\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        {/* 검색 입력창 */}\r\n        <div className=\"flex items-center w-full relative\">\r\n          <input\r\n            type=\"text\"\r\n            className=\"h-[3.5rem] w-full px-6 rounded-lg text-base border bg-gray-100 dark:text-gray-700\"\r\n            placeholder=\"아이템을 검색해보세요\"\r\n            value={searchTerm}\r\n            onChange={handleSearchChange}\r\n            onKeyDown={handleKeyDown}\r\n          />\r\n          <FiSearch\r\n            className=\"absolute right-4 text-gray-700 text-xl cursor-pointer\"\r\n            onClick={() =>\r\n              searchTerm.trim() &&\r\n              (window.location.href = `/searchresult?query=${searchTerm}`)\r\n            }\r\n          />\r\n        </div>\r\n\r\n        {/* 자동완성 검색 결과 */}\r\n        {filteredKeywords.length > 0 && (\r\n          <ul className=\"max-h-8font-semibold text-lg px-2 bg-white rounded shadow\">\r\n            {filteredKeywords.map((keyword, index) => (\r\n              <li\r\n                key={index}\r\n                className=\"px-4 py-4 flex items-center border-b border-gray-100 cursor-pointer hover:bg-gray-50 dark:text-gray-600\"\r\n                onClick={() => handleSearchSelect(keyword)}\r\n              >\r\n                <FiSearch className=\"mr-2 text-gray-600 text-xl\" />\r\n                {keyword}\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearchPageModal;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}